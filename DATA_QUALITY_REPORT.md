# Data Quality Validation Report

**Generated:** 2026-02-17 13:21:17
**Database:** `D:\Python\yangwenli\backend\RUBLI_NORMALIZED.db`
**Total Contracts:** 3,110,007

---
## Pass/Fail Summary

### WARNINGS
- WARNING: contract_date completeness 47.9% below threshold 95%
- WARNING: 935 contracts have start_date > end_date
- WARNING: 20 contracts with invalid years: 2000 (1), 2001 (19)...

### INFORMATIONAL
- INFO: 40 contracts between 10B-100B MXN (flagged for review)
- INFO: 1,355 potential duplicate contract records

---
## 1. Completeness Checks

| Field | Null/Missing | Total | Rate | Threshold | Status |
|-------|-------------|-------|------|-----------|--------|
| vendor_id | 0 | 3,110,007 | 100.00% | 100% | PASS |
| institution_id | 0 | 3,110,007 | 100.00% | 100% | PASS |
| amount_mxn | 1,385 | 3,110,007 | 99.96% | 99% | PASS |
| contract_date | 1,620,323 | 3,110,007 | 47.90% | 95% | FAIL |
| procedure_type | 550 | 3,110,007 | 99.98% | 95% | PASS |
| contract_number | 15,092 | 3,110,007 | 99.51% | 90% | PASS |
| contract_year | 7 | 3,110,007 | 100.00% | 90% | PASS |

---
## 2. Consistency Checks

| Check | Value | Status |
|-------|-------|--------|
| Date sequence violations (start > end) | 935 | FAIL |
| Long duration (>10 years) | 109 | INFO |
| Year mismatches | 0 | PASS |

---
## 3. Validity Checks

| Check | Value | Status |
|-------|-------|--------|
| Contracts > 100B MXN | 0 | PASS |
| Flagged 10B-100B MXN | 40 | INFO |
| Zero amounts | 1,385 (0.04%) | PASS |
| Negative amounts | 0 | PASS |

### Date Anomalies (Invalid Years)

| Year | Count |
|------|-------|
| 2000 | 1 |
| 2001 | 19 |

---
## 4. Uniqueness Checks

| Check | Value |
|-------|-------|
| Unique vendors | 320,429 |
| Unique institutions | 4,456 |
| Duplicate RFC vendors | 0 |
| Potential duplicate contracts | 1,355 |

---
## 5. Referential Integrity

| Foreign Key | Invalid References | Status |
|-------------|-------------------|--------|
| sector_id | 0 | PASS |
| vendor_id | 0 | PASS |
| institution_id | 0 | PASS |
| ramo_id | 0 | PASS |

---
## 6. Statistical Anomaly Detection

### Procurement Patterns

| Metric | Value | Expected | Status |
|--------|-------|----------|--------|
| Direct award rate | 65.6% | 60-75% | PASS |
| Single bid rate (competitive) | 47.6% | <50% | PASS |
| December concentration | 8.1% | <25% | PASS |
| Top 10 vendor concentration | 8.1% | <15% | PASS |

### Sector Distribution

| Sector | Contracts | Percentage |
|--------|-----------|------------|
| Salud | 1,103,317 | 35.5% |
| Agricultura | 454,931 | 14.6% |
| Educacion | 335,853 | 10.8% |
| Infraestructura | 326,592 | 10.5% |
| Energia | 315,967 | 10.2% |
| Hacienda | 151,313 | 4.9% |
| Gobernacion | 120,029 | 3.9% |
| Medio Ambiente | 92,635 | 3.0% |
| Defensa | 79,505 | 2.6% |
| Tecnologia | 52,253 | 1.7% |
| Trabajo | 48,855 | 1.6% |
| Otros | 28,757 | 0.9% |

### Top 10 Vendors by Value

| Vendor | Contracts | Value (MXN) |
|--------|-----------|-------------|
| OPERADORA CICSA, S.A DE C.V.... | 35 | $140,525,195,297 |
| GRUPO FARMACOS ESPECIALIZADOS, S.A. DE C... | 6,360 | $133,360,164,714 |
| FARMACEUTICOS MAYPO S.A DE C.V... | 18,772 | $87,973,938,846 |
| DOWELL SCHLUMBERGER DE MEXICO, S.A.DEC.V... | 97 | $78,462,420,137 |
| MANTENIMIENTO EXPRESS MARITIMO S.A.P.I D... | 9 | $70,516,311,420 |
| URBANISSA SA DE CV... | 52 | $59,059,784,367 |
| LABORATORIOS PISA, S.A. DE C.V.... | 9,281 | $55,642,583,344 |
| TOKA INTERNACIONAL S A P I DE CV... | 1,954 | $53,105,651,990 |
| DISTRIBUIDORA INTERNACIONAL DE MEDICAMEN... | 4,333 | $51,589,703,026 |
| ICA CONSTRUCTORA SA DE CV... | 16 | $44,477,624,120 |

---
## Final Assessment

### PASS - OK TO COMMIT

All blocking criteria have been met. The database is ready for commit.

**Note:** There are warnings that should be reviewed but are not blocking:
- WARNING: contract_date completeness 47.9% below threshold 95%
- WARNING: 935 contracts have start_date > end_date
- WARNING: 20 contracts with invalid years: 2000 (1), 2001 (19)...

---

*Report generated by data_quality_check.py based on OCDS, IMF CRI, and OCP standards.*